(function(){"use strict";var e={3603:function(e,t,r){var o=r(5130),s=r(6768);function i(e,t){const r=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.Wv)(r)}var n=r(1241);const c={},l=(0,n.A)(c,[["render",i]]);var a=l,d=r(1387),u=r(4232);const v={class:"row title-row align-items-center text-center"},p={class:"col-3"},h=["src"],f={class:"container-bg"},b={class:"container text-center"},m={class:"swiperClass"},k=["src"],g=["src"],L={class:"col-1 border border-1"},C={class:"col-3 border border-1"},P={class:"col-1 border border-1"},y={class:"col border border-1"},w=["onUpdate:modelValue","onChange","disabled"],x=["value"],_={class:"col-3 border border-1"},N={class:"col border border-1"},S={class:"row"},D={class:"col-7 border border-1"},E={class:"row"},O={class:"col-7 border border-1"};function j(e,t,i,n,c,l){const a=(0,s.g2)("swiper-slide"),d=(0,s.g2)("swiper");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("header",null,[(0,s.Lk)("div",v,[(0,s.Lk)("div",p,[(0,s.Lk)("img",{src:r(4111)},null,8,h)]),t[0]||(t[0]=(0,s.Lk)("div",{class:"col-9"},[(0,s.Lk)("h2",null,"統包大叔團隊 新成屋輕預算 線上報價試算")],-1))])]),(0,s.Lk)("div",f,[(0,s.Lk)("div",b,[(0,s.Lk)("div",m,[(0,s.bF)(d,{class:"sampleSwiper",module:c.modules,pagination:{clickable:!0}},{default:(0,s.k6)((()=>[(0,s.bF)(a,null,{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:r(7684)},null,8,k)])),_:1}),(0,s.bF)(a,null,{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:r(3693)},null,8,g)])),_:1})])),_:1},8,["module"])]),t[4]||(t[4]=(0,s.Fv)('<div class="row"><div class="col-1 border border-1">序號</div><div class="col-3 border border-1">工程項目</div><div class="col-1 border border-1">單位</div><div class="col border border-1">數量</div><div class="col-3 border border-1">單價</div><div class="col border border-1">總金額</div></div>',1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.processedData,((e,r)=>((0,s.uX)(),(0,s.CE)("div",{class:"row",key:r},[(0,s.Lk)("div",L,(0,u.v_)(e.index),1),(0,s.Lk)("div",C,(0,u.v_)(e.itemName),1),(0,s.Lk)("div",P,(0,u.v_)(e.itemQuantityUnit),1),(0,s.Lk)("div",y,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":e=>c.selectedCount[r]=e,onChange:e=>l.updateTotalPrice(r),disabled:l.isPriceInvalid(e.price)},[t[1]||(t[1]=(0,s.Lk)("option",{value:"0"},"0",-1)),((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(10,(e=>(0,s.Lk)("option",{key:e,value:e},(0,u.v_)(e),9,x))),64))],40,w),[[o.u1,c.selectedCount[r]]])]),(0,s.Lk)("div",_,(0,u.v_)(l.itemCountProcess(e.price)),1),(0,s.Lk)("div",N,(0,u.v_)(l.itemPriceSumProcess(r,e.price)),1)])))),128)),(0,s.Lk)("div",S,[t[2]||(t[2]=(0,s.Lk)("div",{class:"col-5 border border-1"},"總計:",-1)),(0,s.Lk)("div",D," NT$"+(0,u.v_)(l.totalPrice.toLocaleString()),1)]),(0,s.Lk)("div",E,[t[3]||(t[3]=(0,s.Lk)("div",{class:"col-5 border border-1"}," 預估雜項總計(依裝修經驗約為5~10%↑): ",-1)),(0,s.Lk)("div",O," NT$ "+(0,u.v_)(l.totalPriceWithExtra(c.minAddition).toLocaleString())+" ~ NT$ "+(0,u.v_)(l.totalPriceWithExtra(c.maxAddition).toLocaleString()),1)]),t[5]||(t[5]=(0,s.Lk)("div",{class:"row note-content border border-2"},[(0,s.Lk)("div",{class:"col"},[(0,s.eW)(" 說明:此線上估價試算系統使用期限約為3天，裝修金額隨著個人需求會有些許調整。"),(0,s.Lk)("br"),(0,s.eW)(" 試算後有符合者，本公司收費3,000元(合作後可併入工程款)，以利安排場勘及施工前準備及進度表。"),(0,s.Lk)("br"),(0,s.eW)(" 匯款帳號:星展銀行(810)中壢分行 6709209238 達圓室內裝修工程有限公司 ")])],-1))])])],64)}r(4114);var $=r(844),T=r(8174),F={data(){return{modules:[$.Pagination],processedData:[],selectedCount:[],customCount:[],minAddition:5,maxAddition:10}},components:{Swiper:T.RC,SwiperSlide:T.qr},methods:{fetchGoogleSheet(){const e="AIzaSyCblqD68QVjdlMY5jN10euonBBGopL0J08",t="1hUJ9GPEiwBh9yO8NIGfehOWKMDy4lkmy4H2QaNamr9g",r="工作表1",o=`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/${r}?key=${e}`;fetch(o).then((e=>e.json())).then((e=>{console.log(e),this.processedData=[],this.selectedCount=[],this.customCount=[],this.sheetDataProcess(e.values)})).catch((e=>{console.error("Error:",e)}))},sheetDataProcess(e){let t=!1;e.forEach((e=>{if(""===e[0])return;if(!t)return void(t=!0);const r={index:e[0],itemName:e[1],itemQuantityUnit:e[2],count:0,price:this.priceProcess(e[4])};this.processedData.push(r),this.selectedCount.push(0),this.customCount.push("")}))},updateSelect(e){this.selectedCount[e]=this.customCount[e],this.updateTotalPrice(e)},updateTotalPrice(e){const t=this.selectedCount[e]||this.customCount[e]||0;this.processedData[e].count=Number(t),this.processedData[e].totalPrice=this.processedData[e].count*this.processedData[e].price},priceProcess(e){return"string"===typeof e&&e.includes("NT$")?Number(e.replace(/[^\d]/g,"")):e},itemCountProcess(e){return"number"!==typeof e||isNaN(e)?e:`NT$ ${e.toLocaleString()}元`},itemPriceSumProcess(e,t){return void 0===t||void 0===e||"number"!==typeof this.selectedCount[e]||"number"!==typeof t?"":`NT$ ${(this.selectedCount[e]*t).toLocaleString()}元`},isPriceInvalid(e){return void 0===e||""===e||"string"===typeof e&&!/\d/.test(e)},totalPriceWithExtra(e){return this.totalPrice*(1+e/100)}},computed:{totalPrice(){return this.processedData.reduce(((e,t,r)=>{const o=this.selectedCount[r]||this.customCount[r]||0;return e+(o*t.price||0)}),0)||0}},mounted(){this.fetchGoogleSheet()}};const W=(0,n.A)(F,[["render",j]]);var A=W;const I=[{path:"/",name:"home",component:A}],B=(0,d.aE)({history:(0,d.Bt)(),routes:I});var G=B,U=r(782),X=(0,U.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,o.Ef)(a).use(X).use(G).mount("#app")},4111:function(e,t,r){e.exports=r.p+"img/logo.1ed2fc5c.png"},7684:function(e,t,r){e.exports=r.p+"img/20200926133419jnum2.1f6da5d4.jpg"},3693:function(e,t,r){e.exports=r.p+"img/20200926134016uz826.e681d5cf.jpg"}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,o,s,i){if(!o){var n=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],i=e[d][2];for(var c=!0,l=0;l<o.length;l++)(!1&i||n>=i)&&Object.keys(r.O).every((function(e){return r.O[e](o[l])}))?o.splice(l--,1):(c=!1,i<n&&(n=i));if(c){e.splice(d--,1);var a=s();void 0!==a&&(t=a)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[o,s,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.p="/BuildCalc/"}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,i,n=o[0],c=o[1],l=o[2],a=0;if(n.some((function(t){return 0!==e[t]}))){for(s in c)r.o(c,s)&&(r.m[s]=c[s]);if(l)var d=l(r)}for(t&&t(o);a<n.length;a++)i=n[a],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(d)},o=self["webpackChunkbuild_calculator"]=self["webpackChunkbuild_calculator"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(3603)}));o=r.O(o)})();
//# sourceMappingURL=app.129754f7.js.map